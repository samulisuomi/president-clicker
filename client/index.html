<!DOCTYPE html>
<html>

<head>
    <title>President Clicker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        html, body {
            height: 100%;
            background-color: #273251;
            margin: 0;
            text-align: center;
            color: pink;
            font-size: 16px;
        }

        body {
            padding: 12px;
        }

        h1 {
            font-size: 200%;
        }

        p {
            font-size: 100%;
            line-height: 1.2;
        }

        .flex-container {
            min-height: 100%;
            width: 100%;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            flex-wrap: nowrap;
            justify-content: space-between;
            align-items: center;
        }

        .row {
            width: 100%;
            max-width: 1280px;
            max-height: 512px;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: row;
            flex-wrap: nowrap;
            justify-content: space-around;
            align-items: center;
        }

        .face {
            display: flex;
            flex-direction: column;
            flex-wrap: nowrap;
            justify-content: center;
        }

        img {
            max-height: 512px;
            max-width: 100%;
        }
    </style>
</head>

<body>
    <div class="flex-container">
        <header>
            <h1>President Clicker</h1>
            <p>Trump: <span id="trumpScoreWorld"></span> (everybody), <span id="trumpScore">0</span> (you)</p>
            <p>Hillary: <span id="hillaryScoreWorld"></span> (everybody), <span id="hillaryScore">0</span> (you)</p>
        </header>
        <div class="row">
            <div class="face">
                <img id="trump" src="images/trump.svg">
            </div>
            <div class="face">
                <img id="hillary" src="images/hillary.svg">
            </div>
        </div>
        <footer>
            <p>About</p>
        </footer>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.8/socket.io.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
        var socket;
        var socketOptions = {
            path: "/presidentclicker",
            transports: ["websocket"]
        }
        if (window.location.host.indexOf("localhost") === -1) {
            socket = io("http://37.139.14.210", socketOptions);
        } else {
            socket = io("localhost:3000", socketOptions);
        }

        var trump = document.getElementById("trump");
        var hillary = document.getElementById("hillary");
        var trumpScoreWorld = document.getElementById("trumpScoreWorld");
        var hillaryScoreWorld = document.getElementById("hillaryScoreWorld");
        var trumpScoreWorldCount = -1;
        var hillaryScoreWorldCount = -1;
        var trumpScore = document.getElementById("trumpScore");
        var hillaryScore = document.getElementById("hillaryScore");
        var trumpScoreCount = 0;
        var hillaryScoreCount = 0;

        trump.onclick = function() {
            socket.emit("trump", "1");
            trumpScoreCount++;
            trumpScore.innerHTML = trumpScoreCount;
            if (trumpScoreWorldCount !== -1) {
                trumpScoreWorldCount++;
                trumpScoreWorld.innerHTML = trumpScoreWorldCount;
            }
            return false;
        };

        hillary.onclick = function() {
            socket.emit("hillary", "1");
            hillaryScoreCount++;
            hillaryScore.innerHTML = hillaryScoreCount;
            if (hillaryScoreWorldCount !== -1) {
                hillaryScoreWorldCount++;
                hillaryScoreWorld.innerHTML = hillaryScoreWorldCount;
            }
            return false;
        };

        socket.on("score.trump", function(msg) {
            trumpScoreWorldCount = Number(msg);
            trumpScoreWorld.innerHTML = trumpScoreWorldCount;
        });

        socket.on("score.hillary", function(msg) {
            hillaryScoreWorldCount = Number(msg);
            hillaryScoreWorld.innerHTML = hillaryScoreWorldCount;
        });

        function preventZoom(e) {
            var t2 = e.timeStamp;
            var t1 = e.currentTarget.dataset.lastTouch || t2;
            var dt = t2 - t1;
            var fingers = e.touches.length;
            e.currentTarget.dataset.lastTouch = t2;

            if (!dt || dt > 500 || fingers > 1) return; // not double-tap

            e.preventDefault();
            e.target.click();
        }
    </script>
</body>

</html>
